# Миграция: Добавление поля для родительного падежа

## Что было сделано

Добавлена система для правильного отображения целевой аудитории в родительном падеже для фразы "Конкурс для..."

### Изменения:

1. **База данных**
   - Добавлено новое поле `target_participants_genitive` в таблицу `competitions`
   - Создан SQL-скрипт миграции с автоматическим заполнением для распространенных случаев

2. **Класс Competition** (`classes/Competition.php`)
   - Добавлена поддержка нового поля в методах `create()` и `update()`

3. **Форма редактирования** (`admin/competitions/edit.php`)
   - Добавлены два поля:
     - "Целевая аудитория (именительный падеж)" - для хранения в именительном падеже
     - "Целевая аудитория (родительный падеж)" - для фразы "Конкурс для..."

4. **Страница конкурса** (`pages/competition-detail.php`)
   - Обновлена для использования нового поля с fallback на старое поле

## Как применить миграцию

### Способ 1: Через веб-интерфейс (рекомендуется)

1. Откройте в браузере: `http://localhost:8080/database/migrate.php`
2. Нажмите кнопку "Выполнить миграцию"
3. Дождитесь сообщения об успешном выполнении

### Способ 2: Через командную строку

```bash
cd database
mysql -u root -p pedagogy_platform < migrations/add_target_participants_genitive.sql
```

## После миграции

1. **Откройте админ-панель**: `http://localhost:8080/admin/index.php`

2. **Отредактируйте существующие конкурсы**:
   - Нажмите "Редактировать" на каждом конкурсе
   - Заполните поле "Целевая аудитория (родительный падеж)"

   **Примеры:**
   - Именительный падеж: "Воспитатели дошкольных образовательных учреждений"
   - Родительный падеж: "воспитателей дошкольных образовательных учреждений"

   - Именительный падеж: "Учителя начальных классов"
   - Родительный падеж: "учителей начальных классов"

3. **Проверьте результат**:
   - Откройте страницу конкурса
   - Убедитесь, что в верхней части отображается правильный текст
   - Пример: "КОНКУРС ДЛЯ ВОСПИТАТЕЛЕЙ ДОШКОЛЬНЫХ ОБРАЗОВАТЕЛЬНЫХ УЧРЕЖДЕНИЙ"

## Автоматическое заполнение

Миграция автоматически заполнит поле для следующих типов:
- Воспитатели → воспитателей дошкольных образовательных учреждений
- Учителя → учителей общеобразовательных учреждений
- Педагоги → педагогов образовательных учреждений
- Методисты → методистов образовательных учреждений
- Студенты → студентов педагогических учебных заведений

Если ваши конкурсы не попадают под эти категории, вам нужно будет вручную заполнить поля в админ-панели.

## Совместимость

Если поле `target_participants_genitive` не заполнено, система автоматически использует старое поле `target_participants` в качестве fallback. Это обеспечивает обратную совместимость.

## Откат миграции (при необходимости)

Если нужно откатить изменения:

```sql
ALTER TABLE competitions DROP COLUMN target_participants_genitive;
```

---

**Дата создания:** 2026-01-16
**Автор:** Claude Code Assistant
