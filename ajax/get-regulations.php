<?php
/**
 * Get Competition Regulations AJAX Endpoint
 * Returns the regulations content for a specific competition
 */

header('Content-Type: application/json');

require_once __DIR__ . '/../config/database.php';
require_once __DIR__ . '/../classes/Database.php';
require_once __DIR__ . '/../classes/Competition.php';

// Get competition ID from request
$competitionId = $_GET['competition_id'] ?? '';

if (empty($competitionId)) {
    echo json_encode([
        'success' => false,
        'message' => 'ID конкурса не указан'
    ]);
    exit;
}

// Get competition data
$competitionObj = new Competition($db);
$competition = $competitionObj->getById($competitionId);

if (!$competition) {
    echo json_encode([
        'success' => false,
        'message' => 'Конкурс не найден'
    ]);
    exit;
}

// Generate regulations content based on competition data
$content = generateRegulationsContent($competition);

echo json_encode([
    'success' => true,
    'content' => $content
]);

/**
 * Generate regulations content for a competition
 * @param array $competition Competition data
 * @return string HTML content
 */
function generateRegulationsContent($competition) {
    $title = htmlspecialchars($competition['title']);
    $category = Competition::getCategoryLabel($competition['category']);
    $targetParticipants = htmlspecialchars($competition['target_participants'] ?: 'педагогические работники любых образовательных учреждений');

    $content = <<<HTML
<h3>Общие положения</h3>
<p><strong>1.</strong> Конкурс проводится по инициативе редакции Эл СМИ «ФГОС-Практикум». Свидетельство о регистрации РОСКОМНАДЗОР Эл. №ФС 77-74524 от 24.12.2018 выдано Федеральной службой по надзору в сфере связи, информационных технологий и массовых коммуникаций. Зарегистрированная территория распространения: Российская Федерация, зарубежные страны. Конкурсная площадка — https://fgos.pro</p>

<p><strong>2.</strong> Всероссийский конкурс «{$title}» проводится в соответствии ч. 2 ст. 77 и п. 22 ст. 34 Федерального закона Российской Федерации «Об образовании в Российской Федерации» № 273-ФЗ от 29.12.2012 г. (в ред. от 31.12.2014) и направлен на поддержку творческого потенциала педагогических работников.</p>

<h3>Цели и задачи Конкурса</h3>
<p><strong>1. Цель:</strong> пропаганда и внедрение личностно развивающих, компетентностно-ориентированных образовательных технологий; представление и популяризация педагогического опыта работников образования.</p>

<p><strong>2. Задачи:</strong></p>
<ul>
    <li>разработка новшеств в обучении и организации образовательного процесса;</li>
    <li>содействие эффективному формированию ключевых компетентностей обучающихся через создание развивающей образовательной среды;</li>
    <li>актуализация интеллектуальных и творческих способностей педагогов.</li>
</ul>

<h3>Участники Конкурса</h3>
<p><strong>1.</strong> Принять участие в Конкурсе могут {$targetParticipants}.</p>

<p><strong>2.</strong> Возраст участников не ограничивается, педагогический стаж не учитывается.</p>

<p><strong>3.</strong> Участие может быть индивидуальным или совместным. Количество авторов совместной работы — не более трех.</p>

<h3>Предмет и содержание Конкурса</h3>
<p><strong>1.</strong> Предметом Конкурса являются работы для категории «{$category}». Работы могут являться новыми материалами или уже прошедшими апробацию.</p>

<p><strong>2.</strong> Конкурс проводится в заочной форме. Тематика материалов не ограничивается, однако материалы должны иметь образовательный характер и не противоречить общепризнанным научным фактам, этическим нормам и законодательству Российской Федерации.</p>

<p><strong>3.</strong> Конкурсные работы должны быть авторскими, т.е. разработаны непосредственно участником Конкурса.</p>

<h3>Критерии оценки материалов Конкурса</h3>
<ul>
    <li>Целесообразность материала</li>
    <li>Оригинальность материала</li>
    <li>Полнота и информативность материала</li>
    <li>Научная и фактическая достоверность материала</li>
    <li>Стиль и доходчивость изложения, логичность структуры материала</li>
    <li>Качество оформления и наглядность материала</li>
    <li>Возможность широкого практического использования материала</li>
</ul>

<h3>Требования к конкурсным материалам</h3>
<p><strong>1.</strong> Материалы на Конкурс принимаются в электронном виде на русском языке.</p>

<p><strong>2.</strong> Работа должна содержать: название, ФИО автора, должность, наименование образовательного учреждения, местонахождение образовательного учреждения.</p>

<p><strong>3.</strong> Материал подготавливается в формате MS WORD, имя файла — ФамилияИО автора работы (например, ПетровНН); также могут быть приложены файлы поддержки, необходимые для представления конкурсной работы.</p>

<p><strong>4.</strong> Для пересылки по электронной почте конкурсный материал желательно архивировать. Максимальный размер архива с конкурсной работой – 100 Мб.</p>

<h3>Подведение итогов и награждение</h3>
<p><strong>1.</strong> Все участники Конкурса получают дипломы участников или победителей в электронном виде.</p>

<p><strong>2.</strong> Дипломы доступны для скачивания в личном кабинете сразу после оплаты участия.</p>

<p><strong>3.</strong> Все дипломы являются официальными документами и могут быть использованы для аттестации, портфолио и других профессиональных целей.</p>

<h3>Контактная информация</h3>
<p>По всем вопросам, связанным с проведением Конкурса, обращайтесь по электронной почте: <a href="mailto:info@fgos.pro">info@fgos.pro</a></p>

<h3>Реквизиты организатора</h3>
<p><strong>ООО «Едурегионлаб»</strong><br>
ИНН 5904368615 / КПП 773101001<br>
121205, Россия, г. Москва, вн.тер.г. Муниципальный округ Можайский, тер. Инновационного центра Сколково, б-р Большой, д. 42, стр. 1</p>

<p><strong>Банковские реквизиты:</strong><br>
р/с 40702810049770043643<br>
Волго-Вятский банк ПАО Сбербанк<br>
БИК 042202603 / к/с 30101810900000000603</p>

<p><strong>Лицензия:</strong> № Л035-01212-59/00203856 от 17.12.2021 г.</p>
HTML;

    return $content;
}
